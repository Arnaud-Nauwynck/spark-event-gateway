<H3>Spark App {{sparkAppKey.displayText}} - Longest Job Executions</H3>

@if (longestJobExecs) {
  <app-spark-job-summary-table [sparkAppKey]="sparkAppKey"
                               [items]="longestJobExecs" [showLinkAsNthLongest]="true"/>

} @else {
  <p>No Spark App found for {{sparkAppKey.displayText}}</p>
}


@if (repeatedLongestTopLevelExecsPerCallSites) {
  @if (repeatedLongestTopLevelExecsPerCallSites.length > 0) {
    <H3>Repeated Longest TopLevelJob Executions Per Call Site (retain top {{repeatedLongestTopLevelExecsPerCallSites.length}} order by Sum duration, where count>1)</H3>

    <ul>
      @for(repeatPerCallSite of repeatedLongestTopLevelExecsPerCallSites; track repeatPerCallSite.callSite; let perCallSiteIndex = $index) {
        <li>
          @let callSite = repeatPerCallSite.callSite;
          <label>{{perCallSiteIndex+1}} Nth, Sum Duration={{repeatPerCallSite.durationSum / 1000}} seconds, Count={{repeatPerCallSite.count}} </label>
          <br/>
          {{callSite.shortMessage}}

          <app-spark-job-summary-table [sparkAppKey]="sparkAppKey"
                                       [items]="repeatPerCallSite.jobExecs"/>
        </li>
      }
    </ul>
  }
}
